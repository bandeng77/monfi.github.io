<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Finance Monitoring System</title>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        :root {
            --primary: #2563eb;
            --primary-dark: #1d4ed8;
            --secondary: #64748b;
            --success: #10b981;
            --warning: #f59e0b;
            --danger: #ef4444;
            --light: #f8fafc;
            --dark: #1e293b;
            --gray: #94a3b8;
            --border: #e2e8f0;
            --bg: #ffffff;
            --card-bg: #ffffff;
            --sidebar-bg: #f1f5f9;
            --hover: #f8fafc;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Inter', sans-serif;
            background-color: #ffffff;
            color: #334155;
            line-height: 1.6;
            min-height: 100vh;
        }

        /* ========== IMPROVED LOGIN STYLES ========== */
        .auth-container {
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            background: linear-gradient(135deg, #ffffff 0%, #ffffff 100%);
            padding: 20px;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: 2000;
        }

        .auth-card {
            background-color: white;
            border-radius: 16px;
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.1);
            padding: 2.5rem;
            width: 100%;
            max-width: 420px;
            position: relative;
            overflow: hidden;
            animation: fadeIn 0.5s ease-out;
        }

        .auth-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 5px;
            background: linear-gradient(90deg, var(--primary), var(--primary-dark));
        }

        .auth-card h2 {
            text-align: center;
            margin-bottom: 1.5rem;
            color: var(--dark);
            font-weight: 700;
            font-size: 1.75rem;
        }

        .auth-logo {
            display: flex;
            align-items: center;
            justify-content: center;
            margin-bottom: 1.5rem;
        }

        .auth-logo-icon {
            font-size: 2rem;
            color: var(--primary);
            margin-right: 0.75rem;
        }

        .auth-logo-text {
            font-weight: 700;
            font-size: 1.5rem;
            color: var(--dark);
        }

        .auth-form {
            display: flex;
            flex-direction: column;
            gap: 1.25rem;
        }

        .auth-input-group {
            position: relative;
        }

        .auth-input {
            width: 100%;
            padding: 0.9rem 1rem 0.9rem 2.8rem;
            border: 1px solid var(--border);
            border-radius: 8px;
            font-family: inherit;
            font-size: 0.95rem;
            transition: all 0.3s ease;
            background-color: #f8fafc;
        }

        .auth-input:focus {
            outline: none;
            border-color: var(--primary);
            background-color: white;
            box-shadow: 0 0 0 3px rgba(37, 99, 235, 0.1);
        }

        .auth-input-icon {
            position: absolute;
            left: 1rem;
            top: 50%;
            transform: translateY(-50%);
            color: var(--secondary);
            font-size: 1rem;
        }

        .auth-submit-btn {
            padding: 0.9rem 1.5rem;
            border-radius: 8px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            border: none;
            background-color: var(--primary);
            color: white;
            font-size: 1rem;
            margin-top: 0.5rem;
            position: relative;
            overflow: hidden;
        }

        .auth-submit-btn:hover {
            background-color: var(--primary-dark);
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(37, 99, 235, 0.2);
        }

        .auth-submit-btn:active {
            transform: translateY(0);
        }

        .auth-submit-btn.loading {
            pointer-events: none;
            opacity: 0.8;
        }

        .auth-submit-btn.loading::after {
            content: '';
            position: absolute;
            width: 20px;
            height: 20px;
            top: 50%;
            left: 50%;
            margin-left: -10px;
            margin-top: -10px;
            border: 2px solid transparent;
            border-top-color: white;
            border-radius: 50%;
            animation: spin 1s linear infinite;
        }

        .auth-error-message {
            background-color: rgba(239, 68, 68, 0.1);
            color: var(--danger);
            padding: 0.75rem 1rem;
            border-radius: 8px;
            font-size: 0.9rem;
            margin-top: 0.5rem;
            display: none;
            border-left: 4px solid var(--danger);
            text-align: center;
        }

        .auth-footer {
            text-align: center;
            margin-top: 1.5rem;
            font-size: 0.9rem;
            color: var(--secondary);
        }

        .auth-footer a {
            color: var(--primary);
            text-decoration: none;
            font-weight: 500;
        }

        .auth-footer a:hover {
            text-decoration: underline;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        /* ========== EXISTING STYLES (FULL SCREEN) ========== */
        .container {
            display: flex;
            min-height: 100vh;
            width: 100%;
        }

        /* Sidebar Styles */
        .sidebar {
            width: 260px;
            background-color: var(--sidebar-bg);
            border-right: 1px solid var(--border);
            padding: 1.5rem 1rem;
            display: flex;
            flex-direction: column;
            transition: width 0.3s ease;
            position: relative;
            flex-shrink: 0;
        }

        .sidebar.collapsed {
            width: 60px;
        }

        .logo {
            display: flex;
            align-items: center;
            margin-bottom: 2rem;
            padding: 0 0.5rem;
        }

        .logo-icon {
            font-size: 1.8rem;
            color: var(--primary);
            margin-right: 0.75rem;
        }

        .sidebar.collapsed .logo-icon {
            margin-right: 0;
        }

        .logo-text {
            font-weight: 700;
            font-size: 1.25rem;
            color: var(--dark);
            transition: opacity 0.3s ease;
        }

        .sidebar.collapsed .logo-text {
            opacity: 0;
            width: 0;
            overflow: hidden;
        }

        .nav-item {
            display: flex;
            align-items: center;
            padding: 0.75rem 1rem;
            margin-bottom: 0.5rem;
            border-radius: 0.5rem;
            color: var(--secondary);
            text-decoration: none;
            transition: all 0.3s ease;
        }

        .nav-item:hover {
            background-color: var(--hover);
            color: var(--primary);
        }

        .nav-item.active {
            background-color: var(--primary);
            color: white;
        }

        .nav-icon {
            margin-right: 0.75rem;
            font-size: 1.1rem;
            width: 24px;
            text-align: center;
        }

        .sidebar.collapsed .nav-icon {
            margin-right: 0;
        }

        .nav-text {
            font-weight: 500;
            transition: opacity 0.3s ease;
        }

        .sidebar.collapsed .nav-text {
            opacity: 0;
            width: 0;
            overflow: hidden;
        }

        /* Sidebar Toggle Button */
        .sidebar-toggle {
            position: absolute;
            top: 1.5rem;
            right: -12px;
            background-color: var(--primary);
            color: white;
            border: none;
            border-radius: 50%;
            width: 24px;
            height: 24px;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            box-shadow: 0 2px 4px rgba(0,0,0,0.2);
            transition: right 0.3s ease, transform 0.3s ease;
            z-index: 10;
        }

        .sidebar.collapsed .sidebar-toggle {
            right: -12px;
            transform: rotate(180deg);
        }

        /* Main Content Styles */
        .main-content {
            flex: 1;
            padding: 2rem;
            overflow-y: auto;
            transition: margin-left 0.3s ease;
            background-color: #f1f5f9;
        }

        /* Header Styles */
        .header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 2rem;
        }

        .page-title {
            font-size: 1.75rem;
            font-weight: 600;
            color: var(--dark);
        }

        .header-actions {
            display: flex;
            gap: 1rem;
        }

        .btn {
            padding: 0.6rem 1.25rem;
            border-radius: 0.5rem;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.3s ease;
            border: none;
            display: inline-flex;
            align-items: center;
            justify-content: center;
        }

        .btn-primary {
            background-color: var(--primary);
            color: white;
        }

        .btn-primary:hover {
            background-color: var(--primary-dark);
        }

        .btn-outline {
            background-color: transparent;
            border: 1px solid var(--border);
            color: var(--secondary);
        }

        .btn-outline:hover {
            background-color: var(--hover);
        }

        .btn-icon {
            margin-right: 0.5rem;
        }

        /* Card Styles */
        .card {
            background-color: var(--card-bg);
            border-radius: 0.75rem;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.05);
            margin-bottom: 1.5rem;
            overflow: hidden;
        }

        .card-header {
            padding: 1.25rem 1.5rem;
            border-bottom: 1px solid var(--border);
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .card-title {
            font-size: 1.25rem;
            font-weight: 600;
            color: var(--dark);
        }

        .card-body {
            padding: 1.5rem;
        }

        /* Filter Section */
        .filter-section {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(250px, 1fr));
            gap: 1rem;
            margin-bottom: 1.5rem;
        }

        .filter-group {
            display: flex;
            flex-direction: column;
        }

        .filter-label {
            font-size: 0.875rem;
            font-weight: 500;
            margin-bottom: 0.5rem;
            color: var(--secondary);
        }

        .filter-input {
            padding: 0.6rem 1rem;
            border: 1px solid var(--border);
            border-radius: 0.5rem;
            font-family: inherit;
            font-size: 0.95rem;
            width: 100%;
        }

        /* Table Styles */
        .table-container {
            overflow-x: auto;
            border-radius: 0.5rem;
            border: 1px solid var(--border);
        }

        table {
            width: 100%;
            border-collapse: collapse;
            table-layout: auto;
        }

        th, td {
            padding: 0.875rem 1rem;
            text-align: left;
            border-bottom: 1px solid var(--border);
            word-wrap: break-word;
        }

        th {
            background-color: #f8fafc;
            font-weight: 600;
            color: var(--dark);
        }

        td {
            color: var(--secondary);
        }

        tr:last-child td {
            border-bottom: none;
        }

        tr:hover {
            background-color: #f8fafc;
        }

        .status-button {
            display: inline-block;
            padding: 0.35rem 0.75rem;
            border-radius: 1rem;
            font-size: 0.875rem;
            font-weight: 500;
            cursor: pointer;
            border: 1px solid transparent;
            transition: all 0.2s ease;
            text-align: center;
            white-space: nowrap;
        }

        .status-button:hover {
            opacity: 0.9;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }

        .status-paid {
            background-color: #d1fae5;
            color: #065f46;
        }

        .status-pending {
            background-color: #fef3c7;
            color: #92400e;
        }

        .status-overdue {
            background-color: #fee2e2;
            color: #991b1b;
        }

        .status-diajukan-finance {
            background-color: #bfdbfe;
            color: #1e40af;
        }

        .status-diterima-anggi {
            background-color: #dbeafe;
            color: #1e3a8a;
        }

        .status-dibatalkan {
            background-color: #fecaca;
            color: #b91c1c;
        }

        .status-belum-diproses, .status-menunggu-pengajuan {
            background-color: #e2e8f0;
            color: #475569;
        }

        .action-cell {
            display: flex;
            gap: 0.5rem;
            white-space: nowrap;
        }

        .action-btn {
            padding: 0.4rem 0.6rem;
            border-radius: 0.375rem;
            cursor: pointer;
            border: none;
            background: transparent;
            color: var(--secondary);
            transition: all 0.3s ease;
        }

        .action-btn:hover {
            background-color: var(--hover);
            color: var(--primary);
        }

        /* Pagination */
        .pagination {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-top: 1.5rem;
            padding: 1rem 0;
        }

        .page-info {
            font-size: 0.875rem;
            color: var(--secondary);
        }

        .page-controls {
            display: flex;
            gap: 0.5rem;
        }

        .page-btn {
            padding: 0.5rem 0.75rem;
            border-radius: 0.375rem;
            border: 1px solid var(--border);
            background-color: white;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .page-btn:hover {
            background-color: var(--hover);
        }

        .page-btn.active {
            background-color: var(--primary);
            color: white;
            border-color: var(--primary);
        }

        /* Modal Styles */
        .modal {
            display: none;
            position: fixed;
            z-index: 1000;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            overflow: auto;
            background-color: rgba(0,0,0,0.4);
            justify-content: center;
            align-items: center;
        }

        .modal-content {
            background-color: var(--card-bg);
            margin: auto;
            padding: 2rem;
            border-radius: 0.75rem;
            box-shadow: 0 8px 16px rgba(0,0,0,0.2);
            width: 90%;
            max-width: 700px;
            max-height: 90vh;
            overflow-y: auto;
            position: relative;
        }

        .modal-close-btn {
            color: var(--secondary);
            position: absolute;
            top: 1rem;
            right: 1rem;
            font-size: 1.5rem;
            font-weight: bold;
            cursor: pointer;
        }

        .modal-close-btn:hover,
        .modal-close-btn:focus {
            color: var(--dark);
            text-decoration: none;
            cursor: pointer;
        }

        .form-group {
            margin-bottom: 1rem;
        }

        .form-group label {
            display: block;
            margin-bottom: 0.5rem;
            font-weight: 500;
            color: var(--dark);
        }

        .form-group input[type="text"],
        .form-group input[type="date"],
        .form-group select,
        .form-group textarea {
            width: 100%;
            padding: 0.75rem 1rem;
            border: 1px solid var(--border);
            border-radius: 0.5rem;
            font-family: inherit;
            font-size: 0.95rem;
            width: 100%;
        }

        .form-group textarea {
            min-height: 80px;
            resize: vertical;
        }

        .form-actions {
            display: flex;
            justify-content: flex-end;
            gap: 1rem;
            margin-top: 1.5rem;
        }

        .detail-section {
            margin-bottom: 1.5rem;
            padding: 1.5rem;
            border: 1px solid var(--border);
            border-radius: 0.75rem;
            background-color: var(--light);
        }

        .detail-section h3 {
            font-size: 1.1rem;
            font-weight: 600;
            color: var(--dark);
            margin-bottom: 1rem;
            border-bottom: 1px solid var(--border);
            padding-bottom: 0.5rem;
        }

        .detail-item {
            display: flex;
            margin-bottom: 0.5rem;
        }

        .detail-item strong {
            width: 180px;
            flex-shrink: 0;
            color: var(--dark);
        }

        .detail-item span {
            flex-grow: 1;
            color: var(--secondary);
        }

        /* Autocomplete Styles */
        .autocomplete-container {
            position: relative;
            display: inline-block;
            width: 100%;
        }

        .autocomplete-items {
            position: absolute;
            border: 1px solid var(--border);
            border-bottom: none;
            border-top: none;
            z-index: 99;
            top: 100%;
            left: 0;
            right: 0;
            max-height: 200px;
            overflow-y: auto;
            background-color: white;
        }

        .autocomplete-items div {
            padding: 10px;
            cursor: pointer;
            background-color: #fff;
            border-bottom: 1px solid var(--border);
        }

        .autocomplete-items div:hover {
            background-color: var(--hover);
        }

        .autocomplete-active {
            background-color: var(--primary) !important;
            color: #ffffff;
        }

        /* Custom Alert/Notification Styles */
        .custom-alert {
            display: none;
            position: fixed;
            top: 20px;
            left: 50%;
            transform: translateX(-50%);
            padding: 15px 25px;
            border-radius: 8px;
            font-weight: 500;
            color: white;
            z-index: 1001;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
            min-width: 300px;
            text-align: center;
            opacity: 0;
            transition: opacity 0.3s ease-in-out;
        }

        .custom-alert.show {
            opacity: 1;
        }

        .custom-alert.success {
            background-color: var(--success);
        }

        .custom-alert.error {
            background-color: var(--danger);
        }

        .custom-alert.info {
            background-color: var(--primary);
        }

        /* Dashboard Summary Grid */
        .dashboard-summary-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(220px, 1fr));
            gap: 1.5rem;
            margin-top: 1rem;
        }

        .summary-item {
            background-color: var(--light);
            padding: 1.5rem;
            border-radius: 0.75rem;
            text-align: center;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.04);
            transition: transform 0.2s ease;
        }

        .summary-item:hover {
            transform: translateY(-3px);
        }

        .summary-value {
            font-size: 2.2rem;
            font-weight: 700;
            color: var(--primary);
            margin-bottom: 0.5rem;
        }

        .summary-label {
            font-size: 0.95rem;
            font-weight: 500;
            color: var(--secondary);
        }

        /* Specific colors for summary items */
        .summary-item:nth-child(1) .summary-value { color: var(--dark); }
        .summary-item:nth-child(2) .summary-value { color: var(--success); }
        .summary-item:nth-child(3) .summary-value { color: var(--warning); }
        .summary-item:nth-child(4) .summary-value { color: var(--primary); }
        .summary-item:nth-child(5) .summary-value { color: var(--danger); }

        /* Settings Layout */
        .settings-layout {
            display: flex;
            justify-content: center;
            padding-top: 1rem;
        }

        .settings-card {
            background-color: var(--card-bg);
            border-radius: 0.75rem;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.05);
            padding: 2rem;
            width: 100%;
            max-width: 500px;
        }

        /* Checkbox Styles */
        .checkbox-group {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            margin-bottom: 1rem;
        }
        
        .checkbox-group input[type="checkbox"] {
            width: 18px;
            height: 18px;
            cursor: pointer;
        }
        
        .checkbox-group label {
            margin-bottom: 0;
            cursor: pointer;
            font-weight: 500;
            color: var(--dark);
        }

        /* Responsive Styles */
        @media (max-width: 1024px) {
            .container {
                flex-direction: column;
            }
            
            .sidebar {
                width: 100%;
                border-right: none;
                border-bottom: 1px solid var(--border);
                padding: 1rem;
            }
            
            .nav-menu {
                display: flex;
                overflow-x: auto;
                gap: 0.5rem;
                padding-bottom: 0.5rem;
            }
            
            .nav-item {
                margin-bottom: 0;
                white-space: nowrap;
            }

            .sidebar-toggle {
                display: none;
            }
        }

        @media (max-width: 768px) {
            .header {
                flex-direction: column;
                align-items: flex-start;
                gap: 1rem;
            }
            
            .header-actions {
                width: 100%;
                justify-content: space-between;
            }
            
            .filter-section {
                grid-template-columns: 1fr;
            }
            
            .pagination {
                flex-direction: column;
                gap: 1rem;
            }

            .detail-item {
                flex-direction: column;
                align-items: flex-start;
            }

            .detail-item strong {
                width: auto;
                margin-bottom: 0.25rem;
            }

            .table-container {
                overflow-x: auto;
            }

            table {
                min-width: 600px;
            }

            .page-controls {
                flex-wrap: wrap;
                justify-content: center;
            }
        }
    </style>
</head>
<body>
    <!-- Firebase SDKs -->
    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-auth.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-firestore.js"></script>

    <script>
        // Your Firebase configuration
        const firebaseConfig = {
            apiKey: "AIzaSyD-wZ0y0jG-MstU1MPIQQg8pyLnefx8ADQ",
            authDomain: "monitoring-finance.firebaseapp.com",
            projectId: "monitoring-finance",
            storageBucket: "monitoring-finance.firebasestorage.app",
            messagingSenderId: "312581732577",
            appId: "1:312581732577:web:0ee71d80770eea1ed39fa0"
        };

        // Initialize Firebase
        firebase.initializeApp(firebaseConfig);

        const auth = firebase.auth();
        const db = firebase.firestore();

        // Firestore Collections references
        const invoicesCol = db.collection('invoices');
        const fakturPajakCol = db.collection('fakturPajak');
        const pembayaranCol = db.collection('pembayaran');
        const keteranganCol = db.collection('keterangan');

        // --- Custom Alert Function ---
        function showAlert(message, type = 'info', duration = 3000) {
            let alertBox = document.getElementById('custom-alert-box');
            if (!alertBox) {
                alertBox = document.createElement('div');
                alertBox.id = 'custom-alert-box';
                alertBox.className = 'custom-alert';
                document.body.appendChild(alertBox);
            }

            alertBox.textContent = message;
            alertBox.className = `custom-alert ${type}`;
            alertBox.style.display = 'block';

            // Trigger reflow to ensure transition plays
            void alertBox.offsetWidth;
            alertBox.classList.add('show');

            setTimeout(() => {
                alertBox.classList.remove('show');
                alertBox.addEventListener('transitionend', function handler() {
                    alertBox.style.display = 'none';
                    alertBox.removeEventListener('transitionend', handler);
                });
            }, duration);
        }

        // Global variables for invoice data and autocomplete
        let allInvoiceNumbers = [];
        let allInvoiceData = [];
        let filteredInvoiceData = [];
        window.currentPage = 1;
        const itemsPerPage = 10;

        // Global variables to store unsubscribe functions for realtime listeners
        window.invoiceUnsubscribe = null;
        window.dashboardUnsubscribe = null;
        window.reportUnsubscribe = null;

        // Global variables for vendor data
        let allVendorNames = [];

        // Load vendor data
        async function loadVendorData() {
            try {
                const sampleVendors = [
                   "ALARM SUPPLY PTE LTD",
                   "ALLTECH SOLUSINDO",
                   "ALVASTA TEKNOLOGI",
                   "ARSITA UTAMA INDONESIA",
                   "ARSITA UTAMA INDONESIA. PT",
                   "ARTA KENCANA PRIMA MANDIRI",
                   "ASIA CIPTA MANAGEMENT",
                   "AUSTRALINDO GRAHA NUSA",
                   "BUANA SUKSES ABADI",
                   "BUANA SUKSES BERSAMA. PT",
                   "BUMEN CITRA MANDIRI",
                   "CAHAYA BUANA INDOABADI",
                   "CAHAYA KALIMAS UTAMA",
                   "CAKRA MITRA SENTOSA",
                   "CECEP DENI SAPUTRA",
                   "CITRA INTI SEMESTA",
                   "CV. BELTECHINDO",
                   "CV. PRIMA TIMUR JAYA",
                   "DAITO ELEKTRINDO",
                   "DENKO WAHANA SAKTI",
                   "DEXTRANS WORLWIDE INDONESIA. PT",
                   "ECONOMIE MANDIRI",
                   "ETIQA ASURANSI",
                   "FEDEX EXPRESS INTERNATIONAL",
                   "FFE LIMITED",
                   "GECA S.r.I",
                   "GENAIR NUSAINDO",
                   "HASEA CIPTA KARYA",
                   "HIKARI INDO SARANA. PT",
                   "HONEYWELL",
                   "HONEYWELL INDONESIA. PT",
                   "INTIKABEL METALINDO",
                   "ISTANA KEBON JERUK",
                   "KAMIL PUTRA PROTEKSINDO",
                   "KARYA GRAHA CAHAYA",
                   "KARYA GRAHA COMPUTER SUPERMALL",
                   "KIJANG SOLIDEO TEKNIK",
                   "LENTERA TILAS TEHNIK",
                   "MACRON SAFETY SYSTEMS (UK) LIMITED",
                   "MASTER INDO LOGISTICS. PT",
                   "MEDIA MITRA PRATAMA",
                   "METRO JAYA TEKNIK",
                   "MID SOLUSI NUSANTARA. PT",
                   "MITRA MAKMUR SOLUSINDO",
                   "MUHAMMAD FAIK",
                   "MULTRON SYSTEMS PTE. LTD",
                   "OBAY",
                   "PANAH PERDANA LOGISINDO. PT",
                   "PASKALIS",
                   "PETRA CONDUIT",
                   "PRIMA TIMUR JAYA",
                   "PRIMA TUNGGAL JAVALAND",
                   "PROTOCONVERT",
                   "PT TUNAS RIDEAN",
                   "SETYA REKAT ABADI. PT",
                   "SHOPPE INDONESIA",
                   "TEKNIK MAKMUR MANDIRI",
                   "TEPG",
                   "TOKOPEDIA",
                   "VINOTI (VIVERE MULTI KREASI)",
                   "WIDJAJA TEKNIK UTAMA. PT",
                   "YANTO. BPK",
                   "TIRTA INVESTAMA. PT",
                   "FATHONA MARFAZRINA",
                   "HEBEI J&R TRADING CO. LTD",
                   "CAHAYA DELTA MANDIRI",
                   "PRIMACIPTA UNGGUL KARYA",
                   "DATA INTEGRASI SEMESTA",
                   "GLOBAL SECURITY SERVICE INDONESIA",
                   "BERKAH MANDIRI PROTECTION",
                   "PELOPOR PRATAMA LANCAR ABADI",
                   "BETA PANEL",
                   "WARUNG NASI PASUNDAN",
                   "LUBNA PERKASA ABADI",
                   "SIBALEC. PT",
                   "13ROTHER MAFIA KONVEKSI",
                   "UNI NETWORK COMMUNICATIONS",
                   "DENKO WAHANA SAKTI",
                   "ISS INDONESIA",
                   "HORING LIH INDUSTRIAL",
                   "AKARA DIRAYA NAWASENA",
                   "PANDU BINA SENTOSA",
                   "KSO SUCOFINDO - SURVEYOR INDONESIA",
                   "CV KARYA HADIAH KREATIF",
                   "ALFIRE PRIMA INDONEISA",
                   "CITRA INTI SEMESTA",
                   "BAMBANG WINARNO. BPK",
                   "UMROTA KARYA UTAMA",
                   "KAP PIETER. UWAYS & REKAN",
                   "ELPRIMA KENCANA",
                   "BAHTERA BINA SELARAS",
                   "BINEX LOGISTIC",
                   "HOME CENTER INDONESIA RETAIL",
                   "BARAYA PROTEKSINDO ABADI", 
                   "ERAFONE ARTHA RETAILINDO",
                   "CV. AZZA BARAKAH SEJAHTERA",
                   "REJEKI PRIMA STEEL",
                   "SAMSIRA TEKNOLOGI INDONESIA",
                   "BINA GLOBAL TRANSPORT",
                   "ASENWARE INDONESIA JAYA",
                   "AZBIL BERCA INDONESIA",
                   "TEMAN BAIK. CV"
                ];
                
                allVendorNames = sampleVendors;
                setupVendorAutocomplete();
            } catch (error) {
                console.error("Error loading vendor data:", error);
                showAlert("Gagal memuat data vendor: " + error.message, 'error');
            }
        }

        // Setup vendor autocomplete
        function setupVendorAutocomplete() {
            const vendorInput = document.getElementById('invoice-nama-vendor');
            if (vendorInput && allVendorNames.length > 0) {
                autocomplete(vendorInput, allVendorNames);
            }
        }

        // Enhanced autocomplete function to handle multiple fields
        function autocomplete(inp, arr) {
            var currentFocus;
            inp.addEventListener("input", function(e) {
                var a, b, i, val = this.value;
                closeAllLists();
                if (val.length < 1) { return false;}
                currentFocus = -1;
                a = document.createElement("DIV");
                a.setAttribute("id", this.id + "autocomplete-list");
                a.setAttribute("class", "autocomplete-items");
                this.parentNode.appendChild(a);
                for (i = 0; i < arr.length; i++) {
                    if (arr[i].toUpperCase().includes(val.toUpperCase())) {
                        b = document.createElement("DIV");
                        const matchIndex = arr[i].toUpperCase().indexOf(val.toUpperCase());
                        b.innerHTML = arr[i].substring(0, matchIndex) +
                            "<strong>" + arr[i].substring(matchIndex, matchIndex + val.length) + "</strong>" +
                            arr[i].substring(matchIndex + val.length);
                        b.innerHTML += "<input type='hidden' value='" + arr[i] + "'>";
                        b.addEventListener("click", function(e) {
                            inp.value = this.getElementsByTagName("input")[0].value;
                            closeAllLists();
                        });
                        a.appendChild(b);
                    }
                }
            });
            inp.addEventListener("keydown", function(e) {
                var x = document.getElementById(this.id + "autocomplete-list");
                if (x) x = x.getElementsByTagName("div");
                if (e.keyCode == 40) {
                    currentFocus++;
                    addActive(x);
                } else if (e.keyCode == 38) {
                    currentFocus--;
                    addActive(x);
                } else if (e.keyCode == 13) {
                    e.preventDefault();
                    if (currentFocus > -1) {
                        if (x) x[currentFocus].click();
                    }
                }
            });
            function addActive(x) {
                if (!x) return false;
                removeActive(x);
                if (currentFocus >= x.length) currentFocus = 0;
                if (currentFocus < 0) currentFocus = (x.length - 1);
                x[currentFocus].classList.add("autocomplete-active");
            }
            function removeActive(x) {
                for (var i = 0; i < x.length; i++) {
                    x[i].classList.remove("autocomplete-active");
                }
            }
            function closeAllLists(elmnt) {
                var x = document.getElementsByClassName("autocomplete-items");
                for (var i = 0; i < x.length; i++) {
                    if (elmnt != x[i] && elmnt != inp) {
                        x[i].parentNode.removeChild(x[i]);
                    }
                }
            }
            document.addEventListener("click", function (e) {
                closeAllLists(e.target);
            });
        }

        // --- Authentication Functions ---
        function showAuth() {
            document.getElementById('auth-container').style.display = 'flex';
            document.getElementById('app-container').style.display = 'none';
        }

        function showApp() {
            document.getElementById('auth-container').style.display = 'none';
            document.getElementById('app-container').style.display = 'flex';
        }

        function login() {
            const email = document.getElementById('login-email').value;
            const password = document.getElementById('login-password').value;
            const errorMessage = document.getElementById('login-error-message');
            const submitBtn = document.getElementById('login-submit-btn');

            // Basic validation
            if (!email || !password) {
                errorMessage.textContent = 'Email dan password harus diisi';
                errorMessage.style.display = 'block';
                return;
            }

            // Show loading state
            submitBtn.classList.add('loading');
            errorMessage.style.display = 'none';

            // Firebase authentication
            auth.signInWithEmailAndPassword(email, password)
                .then((userCredential) => {
                    // Login successful
                    showAlert('Login berhasil!', 'success');
                    showApp();
                    loadDashboardData();
                    loadInvoiceData();
                    loadVendorData();
                })
                .catch((error) => {
                    // Handle login errors
                    let errorMsg = 'Terjadi kesalahan saat login';
                    switch (error.code) {
                        case 'auth/invalid-email':
                            errorMsg = 'Format email tidak valid';
                            break;
                        case 'auth/user-disabled':
                            errorMsg = 'Akun ini telah dinonaktifkan';
                            break;
                        case 'auth/user-not-found':
                            errorMsg = 'Akun tidak ditemukan';
                            break;
                        case 'auth/wrong-password':
                            errorMsg = 'Password salah';
                            break;
                        default:
                            errorMsg = error.message;
                    }
                    errorMessage.textContent = errorMsg;
                    errorMessage.style.display = 'block';
                })
                .finally(() => {
                    submitBtn.classList.remove('loading');
                });
        }

        function logout() {
            auth.signOut()
                .then(() => {
                    showAlert('Logout berhasil!', 'success');
                    showAuth();
                    // Clear any stored data
                    allInvoiceNumbers = [];
                    allInvoiceData = [];
                    filteredInvoiceData = [];
                    window.currentPage = 1;
                    
                    // Clear any active listeners
                    if (window.invoiceUnsubscribe) {
                        window.invoiceUnsubscribe();
                        window.invoiceUnsubscribe = null;
                    }
                    if (window.dashboardUnsubscribe) {
                        window.dashboardUnsubscribe();
                        window.dashboardUnsubscribe = null;
                    }
                    if (window.reportUnsubscribe) {
                        window.reportUnsubscribe();
                        window.reportUnsubscribe = null;
                    }
                })
                .catch((error) => {
                    showAlert('Gagal logout: ' + error.message, 'error');
                });
        }

        // Check auth state
        auth.onAuthStateChanged((user) => {
            if (user) {
                showApp();
                loadDashboardData();
                loadInvoiceData();
                loadVendorData();
            } else {
                showAuth();
            }
        });

        // --- Navigation Functions ---
        function navigateTo(page) {
            // Hide all pages
            document.querySelectorAll('.page').forEach(p => {
                p.style.display = 'none';
            });

            // Show selected page
            document.getElementById(page).style.display = 'block';

            // Update active nav item
            document.querySelectorAll('.nav-item').forEach(item => {
                item.classList.remove('active');
            });
            document.querySelector(`[onclick="navigateTo('${page}')"]`).classList.add('active');

            // Load page-specific data
            switch (page) {
                case 'dashboard':
                    loadDashboardData();
                    break;
                case 'invoices':
                    loadInvoiceData();
                    break;
                case 'reports':
                    loadReportsData();
                    break;
                case 'settings':
                    loadSettings();
                    break;
            }
        }

        // --- Dashboard Functions ---
        function loadDashboardData() {
            // Unsubscribe from previous listener if exists
            if (window.dashboardUnsubscribe) {
                window.dashboardUnsubscribe();
            }

            // Real-time listener for invoices
            window.dashboardUnsubscribe = invoicesCol.onSnapshot(snapshot => {
                const invoices = [];
                snapshot.forEach(doc => {
                    invoices.push({ id: doc.id, ...doc.data() });
                });

                // Calculate summary data
                const totalInvoices = invoices.length;
                const paidInvoices = invoices.filter(inv => inv.status === 'Paid').length;
                const pendingInvoices = invoices.filter(inv => inv.status === 'Pending').length;
                const overdueInvoices = invoices.filter(inv => inv.status === 'Overdue').length;
                const totalAmount = invoices.reduce((sum, inv) => sum + (parseFloat(inv.amount) || 0), 0);

                // Update dashboard UI
                document.getElementById('total-invoices').textContent = totalInvoices;
                document.getElementById('paid-invoices').textContent = paidInvoices;
                document.getElementById('pending-invoices').textContent = pendingInvoices;
                document.getElementById('overdue-invoices').textContent = overdueInvoices;
                document.getElementById('total-amount').textContent = formatCurrency(totalAmount);

                // Update recent activity table
                updateRecentActivity(invoices.slice(-5).reverse());
            }, error => {
                console.error("Error loading dashboard data:", error);
                showAlert("Gagal memuat data dashboard: " + error.message, 'error');
            });
        }

        function updateRecentActivity(invoices) {
            const tbody = document.getElementById('recent-activity-body');
            if (!tbody) return;

            tbody.innerHTML = '';

            invoices.forEach(invoice => {
                const row = document.createElement('tr');
                
                // Format date
                const invoiceDate = invoice.invoiceDate ? new Date(invoice.invoiceDate.seconds * 1000).toLocaleDateString('id-ID') : '-';
                
                row.innerHTML = `
                    <td>${invoice.invoiceNumber || '-'}</td>
                    <td>${invoice.vendorName || '-'}</td>
                    <td>${invoiceDate}</td>
                    <td>${formatCurrency(invoice.amount || 0)}</td>
                    <td><span class="status-button status-${(invoice.status || '').toLowerCase()}">${invoice.status || 'Unknown'}</span></td>
                `;
                
                tbody.appendChild(row);
            });
        }

        // --- Invoice Functions ---
        function loadInvoiceData() {
            // Unsubscribe from previous listener if exists
            if (window.invoiceUnsubscribe) {
                window.invoiceUnsubscribe();
            }

            // Real-time listener for invoices
            window.invoiceUnsubscribe = invoicesCol.onSnapshot(snapshot => {
                allInvoiceData = [];
                allInvoiceNumbers = [];
                
                snapshot.forEach(doc => {
                    const data = { id: doc.id, ...doc.data() };
                    allInvoiceData.push(data);
                    if (data.invoiceNumber) {
                        allInvoiceNumbers.push(data.invoiceNumber);
                    }
                });

                // Apply any existing filters
                applyInvoiceFilters();
                
                // Setup autocomplete for invoice numbers
                setupInvoiceNumberAutocomplete();
            }, error => {
                console.error("Error loading invoice data:", error);
                showAlert("Gagal memuat data invoice: " + error.message, 'error');
            });
        }

        function setupInvoiceNumberAutocomplete() {
            const invoiceNumberInput = document.getElementById('filter-invoice-number');
            if (invoiceNumberInput && allInvoiceNumbers.length > 0) {
                autocomplete(invoiceNumberInput, allInvoiceNumbers);
            }
        }

        function applyInvoiceFilters() {
            const invoiceNumber = document.getElementById('filter-invoice-number').value.toLowerCase();
            const vendorName = document.getElementById('filter-vendor-name').value.toLowerCase();
            const status = document.getElementById('filter-status').value;
            const startDate = document.getElementById('filter-start-date').value;
            const endDate = document.getElementById('filter-end-date').value;

            filteredInvoiceData = allInvoiceData.filter(invoice => {
                // Filter by invoice number
                if (invoiceNumber && !(invoice.invoiceNumber || '').toLowerCase().includes(invoiceNumber)) {
                    return false;
                }

                // Filter by vendor name
                if (vendorName && !(invoice.vendorName || '').toLowerCase().includes(vendorName)) {
                    return false;
                }

                // Filter by status
                if (status && invoice.status !== status) {
                    return false;
                }

                // Filter by date range
                if (startDate && invoice.invoiceDate) {
                    const invoiceDate = new Date(invoice.invoiceDate.seconds * 1000);
                    const filterStartDate = new Date(startDate);
                    if (invoiceDate < filterStartDate) {
                        return false;
                    }
                }

                if (endDate && invoice.invoiceDate) {
                    const invoiceDate = new Date(invoice.invoiceDate.seconds * 1000);
                    const filterEndDate = new Date(endDate);
                    filterEndDate.setHours(23, 59, 59, 999); // End of the day
                    if (invoiceDate > filterEndDate) {
                        return false;
                    }
                }

                return true;
            });

            // Reset to first page when filters change
            window.currentPage = 1;
            renderInvoiceTable();
            updatePagination();
        }

        function renderInvoiceTable() {
            const tbody = document.getElementById('invoice-table-body');
            if (!tbody) return;

            tbody.innerHTML = '';

            // Calculate pagination
            const startIndex = (window.currentPage - 1) * itemsPerPage;
            const endIndex = startIndex + itemsPerPage;
            const currentPageData = filteredInvoiceData.slice(startIndex, endIndex);

            if (currentPageData.length === 0) {
                const row = document.createElement('tr');
                row.innerHTML = `<td colspan="9" style="text-align: center; padding: 2rem;">Tidak ada data invoice yang sesuai dengan filter</td>`;
                tbody.appendChild(row);
                return;
            }

            currentPageData.forEach(invoice => {
                const row = document.createElement('tr');
                
                // Format dates
                const invoiceDate = invoice.invoiceDate ? new Date(invoice.invoiceDate.seconds * 1000).toLocaleDateString('id-ID') : '-';
                const dueDate = invoice.dueDate ? new Date(invoice.dueDate.seconds * 1000).toLocaleDateString('id-ID') : '-';
                
                // Determine status class
                let statusClass = 'status-unknown';
                if (invoice.status) {
                    statusClass = 'status-' + invoice.status.toLowerCase().replace(/\s+/g, '-');
                }
                
                row.innerHTML = `
                    <td>${invoice.invoiceNumber || '-'}</td>
                    <td>${invoice.vendorName || '-'}</td>
                    <td>${invoiceDate}</td>
                    <td>${dueDate}</td>
                    <td>${formatCurrency(invoice.amount || 0)}</td>
                    <td><span class="status-button ${statusClass}">${invoice.status || 'Unknown'}</span></td>
                    <td>${invoice.paymentMethod || '-'}</td>
                    <td class="action-cell">
                        <button class="action-btn" onclick="viewInvoiceDetails('${invoice.id}')" title="Lihat Detail">
                            <i class="fas fa-eye"></i>
                        </button>
                        <button class="action-btn" onclick="editInvoice('${invoice.id}')" title="Edit">
                            <i class="fas fa-edit"></i>
                        </button>
                        <button class="action-btn" onclick="deleteInvoice('${invoice.id}')" title="Hapus">
                            <i class="fas fa-trash"></i>
                        </button>
                    </td>
                `;
                
                tbody.appendChild(row);
            });
        }

        function updatePagination() {
            const totalPages = Math.ceil(filteredInvoiceData.length / itemsPerPage);
            const pageInfo = document.getElementById('page-info');
            const pageControls = document.getElementById('page-controls');

            if (!pageInfo || !pageControls) return;

            // Update page info
            const startItem = (window.currentPage - 1) * itemsPerPage + 1;
            const endItem = Math.min(window.currentPage * itemsPerPage, filteredInvoiceData.length);
            pageInfo.textContent = `Menampilkan ${startItem}-${endItem} dari ${filteredInvoiceData.length} invoice`;

            // Update pagination controls
            pageControls.innerHTML = '';

            // Previous button
            const prevBtn = document.createElement('button');
            prevBtn.className = 'page-btn';
            prevBtn.innerHTML = '<i class="fas fa-chevron-left"></i>';
            prevBtn.disabled = window.currentPage === 1;
            prevBtn.onclick = () => {
                if (window.currentPage > 1) {
                    window.currentPage--;
                    renderInvoiceTable();
                    updatePagination();
                }
            };
            pageControls.appendChild(prevBtn);

            // Page buttons
            const maxVisiblePages = 5;
            let startPage = Math.max(1, window.currentPage - Math.floor(maxVisiblePages / 2));
            let endPage = Math.min(totalPages, startPage + maxVisiblePages - 1);

            if (endPage - startPage + 1 < maxVisiblePages) {
                startPage = Math.max(1, endPage - maxVisiblePages + 1);
            }

            for (let i = startPage; i <= endPage; i++) {
                const pageBtn = document.createElement('button');
                pageBtn.className = `page-btn ${i === window.currentPage ? 'active' : ''}`;
                pageBtn.textContent = i;
                pageBtn.onclick = () => {
                    window.currentPage = i;
                    renderInvoiceTable();
                    updatePagination();
                };
                pageControls.appendChild(pageBtn);
            }

            // Next button
            const nextBtn = document.createElement('button');
            nextBtn.className = 'page-btn';
            nextBtn.innerHTML = '<i class="fas fa-chevron-right"></i>';
            nextBtn.disabled = window.currentPage === totalPages || totalPages === 0;
            nextBtn.onclick = () => {
                if (window.currentPage < totalPages) {
                    window.currentPage++;
                    renderInvoiceTable();
                    updatePagination();
                }
            };
            pageControls.appendChild(nextBtn);
        }

        function openAddInvoiceModal() {
            document.getElementById('invoice-modal-title').textContent = 'Tambah Invoice Baru';
            document.getElementById('invoice-form').reset();
            document.getElementById('invoice-id').value = '';
            
            // Set default values if needed
            const today = new Date().toISOString().split('T')[0];
            document.getElementById('invoice-tanggal-invoice').value = today;
            
            // Show the modal
            document.getElementById('invoice-modal').style.display = 'flex';
        }

        function closeInvoiceModal() {
            document.getElementById('invoice-modal').style.display = 'none';
        }

        function saveInvoice() {
            const id = document.getElementById('invoice-id').value;
            const formData = {
                invoiceNumber: document.getElementById('invoice-nomor').value,
                vendorName: document.getElementById('invoice-nama-vendor').value,
                invoiceDate: new Date(document.getElementById('invoice-tanggal-invoice').value),
                dueDate: new Date(document.getElementById('invoice-tanggal-jatuh-tempo').value),
                amount: parseFloat(document.getElementById('invoice-jumlah').value) || 0,
                status: document.getElementById('invoice-status').value,
                paymentMethod: document.getElementById('invoice-metode-pembayaran').value,
                description: document.getElementById('invoice-deskripsi').value,
                updatedAt: new Date()
            };

            // Validate required fields
            if (!formData.invoiceNumber || !formData.vendorName || !formData.invoiceDate || !formData.amount) {
                showAlert('Harap isi semua field yang wajib diisi', 'error');
                return;
            }

            if (id) {
                // Update existing invoice
                invoicesCol.doc(id).update(formData)
                    .then(() => {
                        showAlert('Invoice berhasil diperbarui!', 'success');
                        closeInvoiceModal();
                    })
                    .catch(error => {
                        console.error("Error updating invoice:", error);
                        showAlert("Gagal memperbarui invoice: " + error.message, 'error');
                    });
            } else {
                // Add new invoice
                formData.createdAt = new Date();
                invoicesCol.add(formData)
                    .then(() => {
                        showAlert('Invoice berhasil ditambahkan!', 'success');
                        closeInvoiceModal();
                    })
                    .catch(error => {
                        console.error("Error adding invoice:", error);
                        showAlert("Gagal menambahkan invoice: " + error.message, 'error');
                    });
            }
        }

        function editInvoice(id) {
            const invoice = allInvoiceData.find(inv => inv.id === id);
            if (!invoice) {
                showAlert('Invoice tidak ditemukan', 'error');
                return;
            }

            document.getElementById('invoice-modal-title').textContent = 'Edit Invoice';
            document.getElementById('invoice-id').value = id;
            document.getElementById('invoice-nomor').value = invoice.invoiceNumber || '';
            document.getElementById('invoice-nama-vendor').value = invoice.vendorName || '';
            
            // Format dates for input fields
            if (invoice.invoiceDate) {
                const invoiceDate = new Date(invoice.invoiceDate.seconds * 1000);
                document.getElementById('invoice-tanggal-invoice').value = invoiceDate.toISOString().split('T')[0];
            }
            
            if (invoice.dueDate) {
                const dueDate = new Date(invoice.dueDate.seconds * 1000);
                document.getElementById('invoice-tanggal-jatuh-tempo').value = dueDate.toISOString().split('T')[0];
            }
            
            document.getElementById('invoice-jumlah').value = invoice.amount || '';
            document.getElementById('invoice-status').value = invoice.status || '';
            document.getElementById('invoice-metode-pembayaran').value = invoice.paymentMethod || '';
            document.getElementById('invoice-deskripsi').value = invoice.description || '';

            document.getElementById('invoice-modal').style.display = 'flex';
        }

        function deleteInvoice(id) {
            if (confirm('Apakah Anda yakin ingin menghapus invoice ini?')) {
                invoicesCol.doc(id).delete()
                    .then(() => {
                        showAlert('Invoice berhasil dihapus!', 'success');
                    })
                    .catch(error => {
                        console.error("Error deleting invoice:", error);
                        showAlert("Gagal menghapus invoice: " + error.message, 'error');
                    });
            }
        }

        // --- Invoice Details Functions ---
        async function viewInvoiceDetails(id) {
            try {
                // Get invoice data
                const invoiceDoc = await invoicesCol.doc(id).get();
                if (!invoiceDoc.exists) {
                    showAlert('Invoice tidak ditemukan', 'error');
                    return;
                }

                const invoiceData = { id: invoiceDoc.id, ...invoiceDoc.data() };
                
                // Get related data
                const [fakturPajakSnapshot, pembayaranSnapshot, keteranganSnapshot] = await Promise.all([
                    fakturPajakCol.where('invoiceId', '==', id).get(),
                    pembayaranCol.where('invoiceId', '==', id).get(),
                    keteranganCol.where('invoiceId', '==', id).get()
                ]);

                const fakturPajakData = [];
                fakturPajakSnapshot.forEach(doc => {
                    fakturPajakData.push({ id: doc.id, ...doc.data() });
                });

                const pembayaranData = [];
                pembayaranSnapshot.forEach(doc => {
                    pembayaranData.push({ id: doc.id, ...doc.data() });
                });

                const keteranganData = [];
                keteranganSnapshot.forEach(doc => {
                    keteranganData.push({ id: doc.id, ...doc.data() });
                });

                // Populate modal with data
                populateInvoiceDetailsModal(invoiceData, fakturPajakData, pembayaranData, keteranganData);
                
                // Show the modal
                document.getElementById('invoice-details-modal').style.display = 'flex';
            } catch (error) {
                console.error("Error loading invoice details:", error);
                showAlert("Gagal memuat detail invoice: " + error.message, 'error');
            }
        }

        function populateInvoiceDetailsModal(invoiceData, fakturPajakData, pembayaranData, keteranganData) {
            // Format dates
            const formatDate = (timestamp) => {
                if (!timestamp) return '-';
                return new Date(timestamp.seconds * 1000).toLocaleDateString('id-ID', {
                    day: '2-digit',
                    month: '2-digit',
                    year: 'numeric'
                });
            };

            // Populate basic invoice information
            document.getElementById('detail-invoice-number').textContent = invoiceData.invoiceNumber || '-';
            document.getElementById('detail-vendor-name').textContent = invoiceData.vendorName || '-';
            document.getElementById('detail-invoice-date').textContent = formatDate(invoiceData.invoiceDate);
            document.getElementById('detail-due-date').textContent = formatDate(invoiceData.dueDate);
            document.getElementById('detail-amount').textContent = formatCurrency(invoiceData.amount || 0);
            document.getElementById('detail-status').textContent = invoiceData.status || '-';
            document.getElementById('detail-payment-method').textContent = invoiceData.paymentMethod || '-';
            document.getElementById('detail-description').textContent = invoiceData.description || '-';

            // Populate faktur pajak information
            const fakturPajakContainer = document.getElementById('detail-faktur-pajak');
            fakturPajakContainer.innerHTML = '';
            
            if (fakturPajakData.length > 0) {
                fakturPajakData.forEach(faktur => {
                    const fakturDiv = document.createElement('div');
                    fakturDiv.className = 'detail-item';
                    fakturDiv.innerHTML = `
                        <div><strong>Nomor Faktur:</strong> ${faktur.nomorFaktur || '-'}</div>
                        <div><strong>Tanggal Faktur:</strong> ${formatDate(faktur.tanggalFaktur)}</div>
                        <div><strong>DPP:</strong> ${formatCurrency(faktur.dpp || 0)}</div>
                        <div><strong>PPN:</strong> ${formatCurrency(faktur.ppn || 0)}</div>
                        <div><strong>Keterangan:</strong> ${faktur.keterangan || '-'}</div>
                    `;
                    fakturPajakContainer.appendChild(fakturDiv);
                });
            } else {
                fakturPajakContainer.innerHTML = '<div class="detail-item">Tidak ada data faktur pajak</div>';
            }

            // Populate pembayaran information
            const pembayaranContainer = document.getElementById('detail-pembayaran');
            pembayaranContainer.innerHTML = '';
            
            if (pembayaranData.length > 0) {
                pembayaranData.forEach(pembayaran => {
                    const pembayaranDiv = document.createElement('div');
                    pembayaranDiv.className = 'detail-item';
                    pembayaranDiv.innerHTML = `
                        <div><strong>Tanggal Pembayaran:</strong> ${formatDate(pembayaran.tanggalPembayaran)}</div>
                        <div><strong>Jumlah Pembayaran:</strong> ${formatCurrency(pembayaran.jumlahPembayaran || 0)}</div>
                        <div><strong>Metode Pembayaran:</strong> ${pembayaran.metodePembayaran || '-'}</div>
                        <div><strong>Referensi:</strong> ${pembayaran.referensi || '-'}</div>
                        <div><strong>Keterangan:</strong> ${pembayaran.keterangan || '-'}</div>
                    `;
                    pembayaranContainer.appendChild(pembayaranDiv);
                });
            } else {
                pembayaranContainer.innerHTML = '<div class="detail-item">Tidak ada data pembayaran</div>';
            }

            // Populate keterangan information
            const keteranganContainer = document.getElementById('detail-keterangan');
            keteranganContainer.innerHTML = '';
            
            if (keteranganData.length > 0) {
                keteranganData.forEach(keterangan => {
                    const keteranganDiv = document.createElement('div');
                    keteranganDiv.className = 'detail-item';
                    keteranganDiv.innerHTML = `
                        <div><strong>Tanggal:</strong> ${formatDate(keterangan.tanggal)}</div>
                        <div><strong>Keterangan:</strong> ${keterangan.keterangan || '-'}</div>
                        <div><strong>Status:</strong> ${keterangan.status || '-'}</div>
                    `;
                    keteranganContainer.appendChild(keteranganDiv);
                });
            } else {
                keteranganContainer.innerHTML = '<div class="detail-item">Tidak ada data keterangan</div>';
            }
        }

        function closeInvoiceDetailsModal() {
            document.getElementById('invoice-details-modal').style.display = 'none';
        }

        // --- Report Functions ---
        function loadReportsData() {
            // Unsubscribe from previous listener if exists
            if (window.reportUnsubscribe) {
                window.reportUnsubscribe();
            }

            // Real-time listener for reports data
            window.reportUnsubscribe = invoicesCol.onSnapshot(snapshot => {
                const invoices = [];
                snapshot.forEach(doc => {
                    invoices.push({ id: doc.id, ...doc.data() });
                });

                // Update report summary
                updateReportSummary(invoices);
                
                // Update report table
                updateReportTable(invoices);
            }, error => {
                console.error("Error loading report data:", error);
                showAlert("Gagal memuat data laporan: " + error.message, 'error');
            });
        }

        function updateReportSummary(invoices) {
            // Calculate summary data for reports
            const totalInvoices = invoices.length;
            const totalAmount = invoices.reduce((sum, inv) => sum + (parseFloat(inv.amount) || 0), 0);
            const paidInvoices = invoices.filter(inv => inv.status === 'Paid').length;
            const paidAmount = invoices
                .filter(inv => inv.status === 'Paid')
                .reduce((sum, inv) => sum + (parseFloat(inv.amount) || 0), 0);
            const pendingInvoices = invoices.filter(inv => inv.status === 'Pending').length;
            const pendingAmount = invoices
                .filter(inv => inv.status === 'Pending')
                .reduce((sum, inv) => sum + (parseFloat(inv.amount) || 0), 0);

            // Update report summary UI
            document.getElementById('report-total-invoices').textContent = totalInvoices;
            document.getElementById('report-total-amount').textContent = formatCurrency(totalAmount);
            document.getElementById('report-paid-invoices').textContent = paidInvoices;
            document.getElementById('report-paid-amount').textContent = formatCurrency(paidAmount);
            document.getElementById('report-pending-invoices').textContent = pendingInvoices;
            document.getElementById('report-pending-amount').textContent = formatCurrency(pendingAmount);
        }

        function updateReportTable(invoices) {
            const tbody = document.getElementById('report-table-body');
            if (!tbody) return;

            tbody.innerHTML = '';

            // Group by vendor and status for report
            const vendorSummary = {};
            invoices.forEach(invoice => {
                const vendor = invoice.vendorName || 'Unknown Vendor';
                const status = invoice.status || 'Unknown';
                const amount = parseFloat(invoice.amount) || 0;

                if (!vendorSummary[vendor]) {
                    vendorSummary[vendor] = {
                        total: 0,
                        paid: 0,
                        pending: 0,
                        overdue: 0
                    };
                }

                vendorSummary[vendor].total += amount;

                if (status === 'Paid') {
                    vendorSummary[vendor].paid += amount;
                } else if (status === 'Pending') {
                    vendorSummary[vendor].pending += amount;
                } else if (status === 'Overdue') {
                    vendorSummary[vendor].overdue += amount;
                }
            });

            // Populate report table
            Object.keys(vendorSummary).forEach(vendor => {
                const summary = vendorSummary[vendor];
                const row = document.createElement('tr');
                
                row.innerHTML = `
                    <td>${vendor}</td>
                    <td>${formatCurrency(summary.total)}</td>
                    <td>${formatCurrency(summary.paid)}</td>
                    <td>${formatCurrency(summary.pending)}</td>
                    <td>${formatCurrency(summary.overdue)}</td>
                `;
                
                tbody.appendChild(row);
            });
        }

        function exportReport() {
            showAlert('Fitur ekspor laporan akan segera tersedia', 'info');
        }

        // --- Settings Functions ---
        function loadSettings() {
            // Load settings from localStorage or use defaults
            const settings = JSON.parse(localStorage.getItem('finance-monitor-settings')) || {
                notifications: true,
                autoRefresh: true,
                theme: 'light'
            };

            // Update UI with current settings
            document.getElementById('setting-notifications').checked = settings.notifications;
            document.getElementById('setting-auto-refresh').checked = settings.autoRefresh;
            document.getElementById('setting-theme').value = settings.theme;
        }

        function saveSettings() {
            const settings = {
                notifications: document.getElementById('setting-notifications').checked,
                autoRefresh: document.getElementById('setting-auto-refresh').checked,
                theme: document.getElementById('setting-theme').value
            };

            localStorage.setItem('finance-monitor-settings', JSON.stringify(settings));
            showAlert('Pengaturan berhasil disimpan!', 'success');
        }

        // --- Utility Functions ---
        function formatCurrency(amount) {
            return new Intl.NumberFormat('id-ID', {
                style: 'currency',
                currency: 'IDR',
                minimumFractionDigits: 0
            }).format(amount);
        }

        function toggleSidebar() {
            const sidebar = document.getElementById('sidebar');
            sidebar.classList.toggle('collapsed');
        }

        // Initialize the app when DOM is loaded
        document.addEventListener('DOMContentLoaded', function() {
            // Set up event listeners
            document.getElementById('login-submit-btn').addEventListener('click', login);
            document.getElementById('logout-btn').addEventListener('click', logout);
            
            // Set up form submission on Enter key
            document.getElementById('login-password').addEventListener('keypress', function(e) {
                if (e.key === 'Enter') {
                    login();
                }
            });

            // Set up invoice form handlers
            document.getElementById('save-invoice-btn').addEventListener('click', saveInvoice);
            document.getElementById('close-invoice-modal').addEventListener('click', closeInvoiceModal);
            document.getElementById('close-invoice-details-modal').addEventListener('click', closeInvoiceDetailsModal);

            // Set up filter handlers
            document.getElementById('filter-invoice-number').addEventListener('input', applyInvoiceFilters);
            document.getElementById('filter-vendor-name').addEventListener('input', applyInvoiceFilters);
            document.getElementById('filter-status').addEventListener('change', applyInvoiceFilters);
            document.getElementById('filter-start-date').addEventListener('change', applyInvoiceFilters);
            document.getElementById('filter-end-date').addEventListener('change', applyInvoiceFilters);

            // Set up report handlers
            document.getElementById('export-report-btn').addEventListener('click', exportReport);

            // Set up settings handlers
            document.getElementById('save-settings-btn').addEventListener('click', saveSettings);

            // Initialize navigation
            navigateTo('dashboard');
        });

        // Close modals when clicking outside
        window.onclick = function(event) {
            const invoiceModal = document.getElementById('invoice-modal');
            const invoiceDetailsModal = document.getElementById('invoice-details-modal');
            
            if (event.target === invoiceModal) {
                closeInvoiceModal();
            }
            
            if (event.target === invoiceDetailsModal) {
                closeInvoiceDetailsModal();
            }
        };
    </script>

    <!-- Authentication Section -->
    <div id="auth-container" class="auth-container">
        <div class="auth-card">
            <div class="auth-logo">
                <i class="fas fa-chart-line auth-logo-icon"></i>
                <span class="auth-logo-text">Finance Monitor</span>
            </div>
            <h2>Masuk ke Akun Anda</h2>
            <div class="auth-form">
                <div class="auth-input-group">
                    <i class="fas fa-envelope auth-input-icon"></i>
                    <input type="email" id="login-email" class="auth-input" placeholder="Email" required>
                </div>
                <div class="auth-input-group">
                    <i class="fas fa-lock auth-input-icon"></i>
                    <input type="password" id="login-password" class="auth-input" placeholder="Password" required>
                </div>
                <div id="login-error-message" class="auth-error-message"></div>
                <button id="login-submit-btn" class="auth-submit-btn">Masuk</button>
            </div>
            <div class="auth-footer">
                <p>Belum punya akun? <a href="#" onclick="showAlert('Fitur registrasi akan segera tersedia', 'info')">Daftar di sini</a></p>
            </div>
        </div>
    </div>

    <!-- Main Application -->
    <div id="app-container" class="container" style="display: none;">
        <!-- Sidebar -->
        <div id="sidebar" class="sidebar">
            <button class="sidebar-toggle" onclick="toggleSidebar()">
                <i class="fas fa-chevron-left"></i>
            </button>
            <div class="logo">
                <i class="fas fa-chart-line logo-icon"></i>
                <span class="logo-text">Finance Monitor</span>
            </div>
            <div class="nav-menu">
                <a class="nav-item active" onclick="navigateTo('dashboard')">
                    <i class="fas fa-home nav-icon"></i>
                    <span class="nav-text">Dashboard</span>
                </a>
                <a class="nav-item" onclick="navigateTo('invoices')">
                    <i class="fas fa-file-invoice-dollar nav-icon"></i>
                    <span class="nav-text">Invoice</span>
                </a>
                <a class="nav-item" onclick="navigateTo('reports')">
                    <i class="fas fa-chart-bar nav-icon"></i>
                    <span class="nav-text">Laporan</span>
                </a>
                <a class="nav-item" onclick="navigateTo('settings')">
                    <i class="fas fa-cog nav-icon"></i>
                    <span class="nav-text">Pengaturan</span>
                </a>
                <a class="nav-item" id="logout-btn">
                    <i class="fas fa-sign-out-alt nav-icon"></i>
                    <span class="nav-text">Keluar</span>
                </a>
            </div>
        </div>

        <!-- Main Content -->
        <div class="main-content">
            <!-- Dashboard Page -->
            <div id="dashboard" class="page">
                <div class="header">
                    <h1 class="page-title">Dashboard</h1>
                    <div class="header-actions">
                        <button class="btn btn-outline">
                            <i class="fas fa-sync-alt btn-icon"></i> Refresh
                        </button>
                    </div>
                </div>

                <div class="dashboard-summary-grid">
                    <div class="summary-item">
                        <div class="summary-value" id="total-invoices">0</div>
                        <div class="summary-label">Total Invoice</div>
                    </div>
                    <div class="summary-item">
                        <div class="summary-value" id="paid-invoices">0</div>
                        <div class="summary-label">Invoice Dibayar</div>
                    </div>
                    <div class="summary-item">
                        <div class="summary-value" id="pending-invoices">0</div>
                        <div class="summary-label">Invoice Tertunda</div>
                    </div>
                    <div class="summary-item">
                        <div class="summary-value" id="overdue-invoices">0</div>
                        <div class="summary-label">Invoice Terlambat</div>
                    </div>
                    <div class="summary-item">
                        <div class="summary-value" id="total-amount">Rp 0</div>
                        <div class="summary-label">Total Nilai</div>
                    </div>
                </div>

                <div class="card">
                    <div class="card-header">
                        <h2 class="card-title">Aktivitas Terbaru</h2>
                    </div>
                    <div class="card-body">
                        <div class="table-container">
                            <table>
                                <thead>
                                    <tr>
                                        <th>Nomor Invoice</th>
                                        <th>Vendor</th>
                                        <th>Tanggal</th>
                                        <th>Jumlah</th>
                                        <th>Status</th>
                                    </tr>
                                </thead>
                                <tbody id="recent-activity-body">
                                    <!-- Data will be populated by JavaScript -->
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Invoices Page -->
            <div id="invoices" class="page" style="display: none;">
                <div class="header">
                    <h1 class="page-title">Manajemen Invoice</h1>
                    <div class="header-actions">
                        <button class="btn btn-primary" onclick="openAddInvoiceModal()">
                            <i class="fas fa-plus btn-icon"></i> Tambah Invoice
                        </button>
                        <button class="btn btn-outline">
                            <i class="fas fa-download btn-icon"></i> Ekspor
                        </button>
                    </div>
                </div>

                <div class="card">
                    <div class="card-header">
                        <h2 class="card-title">Filter Invoice</h2>
                    </div>
                    <div class="card-body">
                        <div class="filter-section">
                            <div class="filter-group">
                                <label class="filter-label" for="filter-invoice-number">Nomor Invoice</label>
                                <input type="text" id="filter-invoice-number" class="filter-input" placeholder="Cari nomor invoice...">
                            </div>
                            <div class="filter-group">
                                <label class="filter-label" for="filter-vendor-name">Nama Vendor</label>
                                <input type="text" id="filter-vendor-name" class="filter-input" placeholder="Cari nama vendor...">
                            </div>
                            <div class="filter-group">
                                <label class="filter-label" for="filter-status">Status</label>
                                <select id="filter-status" class="filter-input">
                                    <option value="">Semua Status</option>
                                    <option value="Paid">Dibayar</option>
                                    <option value="Pending">Tertunda</option>
                                    <option value="Overdue">Terlambat</option>
                                    <option value="Diajukan ke Finance">Diajukan ke Finance</option>
                                    <option value="Diterima Anggi">Diterima Anggi</option>
                                    <option value="Dibatalkan">Dibatalkan</option>
                                    <option value="Belum Diproses">Belum Diproses</option>
                                    <option value="Menunggu Pengajuan">Menunggu Pengajuan</option>
                                </select>
                            </div>
                            <div class="filter-group">
                                <label class="filter-label" for="filter-start-date">Tanggal Mulai</label>
                                <input type="date" id="filter-start-date" class="filter-input">
                            </div>
                            <div class="filter-group">
                                <label class="filter-label" for="filter-end-date">Tanggal Akhir</label>
                                <input type="date" id="filter-end-date" class="filter-input">
                            </div>
                        </div>
                    </div>
                </div>

                <div class="card">
                    <div class="card-header">
                        <h2 class="card-title">Daftar Invoice</h2>
                    </div>
                    <div class="card-body">
                        <div class="table-container">
                            <table>
                                <thead>
                                    <tr>
                                        <th>Nomor Invoice</th>
                                        <th>Vendor</th>
                                        <th>Tanggal Invoice</th>
                                        <th>Tanggal Jatuh Tempo</th>
                                        <th>Jumlah</th>
                                        <th>Status</th>
                                        <th>Metode Pembayaran</th>
                                        <th>Aksi</th>
                                    </tr>
                                </thead>
                                <tbody id="invoice-table-body">
                                    <!-- Data will be populated by JavaScript -->
                                </tbody>
                            </table>
                        </div>
                        <div class="pagination">
                            <div class="page-info" id="page-info">Menampilkan 0-0 dari 0 invoice</div>
                            <div class="page-controls" id="page-controls">
                                <!-- Pagination buttons will be populated by JavaScript -->
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Reports Page -->
            <div id="reports" class="page" style="display: none;">
                <div class="header">
                    <h1 class="page-title">Laporan Keuangan</h1>
                    <div class="header-actions">
                        <button class="btn btn-primary" id="export-report-btn">
                            <i class="fas fa-download btn-icon"></i> Ekspor Laporan
                        </button>
                    </div>
                </div>

                <div class="card">
                    <div class="card-header">
                        <h2 class="card-title">Ringkasan Laporan</h2>
                    </div>
                    <div class="card-body">
                        <div class="dashboard-summary-grid">
                            <div class="summary-item">
                                <div class="summary-value" id="report-total-invoices">0</div>
                                <div class="summary-label">Total Invoice</div>
                            </div>
                            <div class="summary-item">
                                <div class="summary-value" id="report-total-amount">Rp 0</div>
                                <div class="summary-label">Total Nilai</div>
                            </div>
                            <div class="summary-item">
                                <div class="summary-value" id="report-paid-invoices">0</div>
                                <div class="summary-label">Invoice Dibayar</div>
                            </div>
                            <div class="summary-item">
                                <div class="summary-value" id="report-paid-amount">Rp 0</div>
                                <div class="summary-label">Nilai Dibayar</div>
                            </div>
                            <div class="summary-item">
                                <div class="summary-value" id="report-pending-invoices">0</div>
                                <div class="summary-label">Invoice Tertunda</div>
                            </div>
                            <div class="summary-item">
                                <div class="summary-value" id="report-pending-amount">Rp 0</div>
                                <div class="summary-label">Nilai Tertunda</div>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="card">
                    <div class="card-header">
                        <h2 class="card-title">Laporan per Vendor</h2>
                    </div>
                    <div class="card-body">
                        <div class="table-container">
                            <table>
                                <thead>
                                    <tr>
                                        <th>Nama Vendor</th>
                                        <th>Total Nilai</th>
                                        <th>Dibayar</th>
                                        <th>Tertunda</th>
                                        <th>Terlambat</th>
                                    </tr>
                                </thead>
                                <tbody id="report-table-body">
                                    <!-- Data will be populated by JavaScript -->
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Settings Page -->
            <div id="settings" class="page" style="display: none;">
                <div class="header">
                    <h1 class="page-title">Pengaturan</h1>
                </div>

                <div class="settings-layout">
                    <div class="settings-card">
                        <h2 style="margin-bottom: 1.5rem;">Pengaturan Aplikasi</h2>
                        
                        <div class="form-group">
                            <div class="checkbox-group">
                                <input type="checkbox" id="setting-notifications">
                                <label for="setting-notifications">Aktifkan Notifikasi</label>
                            </div>
                        </div>
                        
                        <div class="form-group">
                            <div class="checkbox-group">
                                <input type="checkbox" id="setting-auto-refresh">
                                <label for="setting-auto-refresh">Auto Refresh Data</label>
                            </div>
                        </div>
                        
                        <div class="form-group">
                            <label for="setting-theme">Tema Aplikasi</label>
                            <select id="setting-theme" class="filter-input">
                                <option value="light">Light</option>
                                <option value="dark">Dark</option>
                                <option value="auto">Auto (Sesuai Sistem)</option>
                            </select>
                        </div>
                        
                        <div class="form-actions">
                            <button class="btn btn-primary" id="save-settings-btn">
                                Simpan Pengaturan
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Add/Edit Invoice Modal -->
    <div id="invoice-modal" class="modal">
        <div class="modal-content">
            <span class="modal-close-btn" id="close-invoice-modal">&times;</span>
            <h2 id="invoice-modal-title">Tambah Invoice Baru</h2>
            
            <form id="invoice-form">
                <input type="hidden" id="invoice-id">
                
                <div class="form-group">
                    <label for="invoice-nomor">Nomor Invoice *</label>
                    <input type="text" id="invoice-nomor" class="filter-input" required>
                </div>
                
                <div class="form-group">
                    <label for="invoice-nama-vendor">Nama Vendor *</label>
                    <input type="text" id="invoice-nama-vendor" class="filter-input" required>
                </div>
                
                <div class="form-group">
                    <label for="invoice-tanggal-invoice">Tanggal Invoice *</label>
                    <input type="date" id="invoice-tanggal-invoice" class="filter-input" required>
                </div>
                
                <div class="form-group">
                    <label for="invoice-tanggal-jatuh-tempo">Tanggal Jatuh Tempo *</label>
                    <input type="date" id="invoice-tanggal-jatuh-tempo" class="filter-input" required>
                </div>
                
                <div class="form-group">
                    <label for="invoice-jumlah">Jumlah (IDR) *</label>
                    <input type="number" id="invoice-jumlah" class="filter-input" step="0.01" min="0" required>
                </div>
                
                <div class="form-group">
                    <label for="invoice-status">Status</label>
                    <select id="invoice-status" class="filter-input">
                        <option value="Pending">Tertunda</option>
                        <option value="Paid">Dibayar</option>
                        <option value="Overdue">Terlambat</option>
                        <option value="Diajukan ke Finance">Diajukan ke Finance</option>
                        <option value="Diterima Anggi">Diterima Anggi</option>
                        <option value="Dibatalkan">Dibatalkan</option>
                        <option value="Belum Diproses">Belum Diproses</option>
                        <option value="Menunggu Pengajuan">Menunggu Pengajuan</option>
                    </select>
                </div>
                
                <div class="form-group">
                    <label for="invoice-metode-pembayaran">Metode Pembayaran</label>
                    <input type="text" id="invoice-metode-pembayaran" class="filter-input">
                </div>
                
                <div class="form-group">
                    <label for="invoice-deskripsi">Deskripsi</label>
                    <textarea id="invoice-deskripsi" class="filter-input" rows="3"></textarea>
                </div>
                
                <div class="form-actions">
                    <button type="button" class="btn btn-outline" onclick="closeInvoiceModal()">Batal</button>
                    <button type="button" class="btn btn-primary" id="save-invoice-btn">Simpan Invoice</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Invoice Details Modal -->
    <div id="invoice-details-modal" class="modal">
        <div class="modal-content">
            <span class="modal-close-btn" id="close-invoice-details-modal">&times;</span>
            <h2>Detail Invoice</h2>
            
            <div class="detail-section">
                <h3>Informasi Utama</h3>
                <div class="detail-item">
                    <strong>Nomor Invoice:</strong>
                    <span id="detail-invoice-number">-</span>
                </div>
                <div class="detail-item">
                    <strong>Nama Vendor:</strong>
                    <span id="detail-vendor-name">-</span>
                </div>
                <div class="detail-item">
                    <strong>Tanggal Invoice:</strong>
                    <span id="detail-invoice-date">-</span>
                </div>
                <div class="detail-item">
                    <strong>Tanggal Jatuh Tempo:</strong>
                    <span id="detail-due-date">-</span>
                </div>
                <div class="detail-item">
                    <strong>Jumlah:</strong>
                    <span id="detail-amount">-</span>
                </div>
                <div class="detail-item">
                    <strong>Status:</strong>
                    <span id="detail-status">-</span>
                </div>
                <div class="detail-item">
                    <strong>Metode Pembayaran:</strong>
                    <span id="detail-payment-method">-</span>
                </div>
                <div class="detail-item">
                    <strong>Deskripsi:</strong>
                    <span id="detail-description">-</span>
                </div>
            </div>
            
            <div class="detail-section">
                <h3>Faktur Pajak</h3>
                <div id="detail-faktur-pajak">
                    <!-- Faktur pajak data will be populated here -->
                </div>
            </div>
            
            <div class="detail-section">
                <h3>Pembayaran</h3>
                <div id="detail-pembayaran">
                    <!-- Pembayaran data will be populated here -->
                </div>
            </div>
            
            <div class="detail-section">
                <h3>Keterangan</h3>
                <div id="detail-keterangan">
                    <!-- Keterangan data will be populated here -->
                </div>
            </div>
            
            <div class="form-actions">
                <button type="button" class="btn btn-primary" onclick="closeInvoiceDetailsModal()">Tutup</button>
            </div>
        </div>
    </div>
</body>
</html>
